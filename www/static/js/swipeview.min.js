var SwipeView=function(){var a="ontouchstart"in window,b="onorientationchange"in window?"orientationchange":"resize",c=a?"touchstart":"mousedown",d=a?"touchmove":"mousemove",e=a?"touchend":"mouseup",f=a?"touchcancel":"mouseup",g=function(a,f){var g,h,i,j;this.wrapper=typeof a=="string"?document.querySelector(a):a;this.options={text:null,numberOfPages:3,snapThreshold:null,hastyPageFlip:true,loop:true};for(g in f)this.options[g]=f[g];this.wrapper.style.overflow="hidden";this.masterPages=[];h=document.createElement("div");h.id="swipeview-slider";h.style.cssText="position:relative;top:0;height:100%;width:100%;-webkit-transition-duration:0;-webkit-transform:translate3d(0,0,0) translateZ(0);-webkit-transition-timing-function:ease-out";this.wrapper.appendChild(h);this.slider=h;this.refreshSize();for(g=-1;g<2;g++){h=document.createElement("div");h.id="swipeview-masterpage-"+(g+1);h.style.cssText="-webkit-transform:translateZ(0);position:absolute;top:0;height:100%;width:100%;left:"+g*100+"%";if(!h.dataset)h.dataset={};j=g==-1?this.options.numberOfPages-1:g;h.dataset.pageIndex=j;h.dataset.upcomingPageIndex=j;if(!this.options.loop&&g==-1)h.style.visibility="hidden";this.slider.appendChild(h);this.masterPages.push(h)}i=this.masterPages[1].className;this.masterPages[1].className=!i?"swipeview-active":i+" swipeview-active";window.addEventListener(b,this,false);this.wrapper.addEventListener(c,this,false);this.wrapper.addEventListener(d,this,false);this.wrapper.addEventListener(e,this,false);this.slider.addEventListener("webkitTransitionEnd",this,false)};g.prototype={currentMasterPage:1,x:0,page:0,pageIndex:0,customEvents:[],onFlip:function(a){this.wrapper.addEventListener("swipeview-flip",a,false);this.customEvents.push(["flip",a])},onMoveOut:function(a){this.wrapper.addEventListener("swipeview-moveout",a,false);this.customEvents.push(["moveout",a])},onMoveIn:function(a){this.wrapper.addEventListener("swipeview-movein",a,false);this.customEvents.push(["movein",a])},onTouchStart:function(a){this.wrapper.addEventListener("swipeview-touchstart",a,false);this.customEvents.push(["touchstart",a])},destroy:function(){while(this.customEvents.length){this.wrapper.removeEventListener("swipeview-"+this.customEvents[0][0],this.customEvents[0][1],false);this.customEvents.shift()}window.removeEventListener(b,this,false);this.wrapper.removeEventListener(c,this,false);this.wrapper.removeEventListener(d,this,false);this.wrapper.removeEventListener(e,this,false);this.slider.removeEventListener("webkitTransitionEnd",this,false)},refreshSize:function(){this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.pageWidth=this.wrapperWidth;this.maxX=-this.options.numberOfPages*this.pageWidth+this.wrapperWidth;this.snapThreshold=this.options.snapThreshold===null?Math.round(this.pageWidth*.15):/%/.test(this.options.snapThreshold)?Math.round(this.pageWidth*this.options.snapThreshold.replace("%","")/100):this.options.snapThreshold},updatePageCount:function(a){this.options.numberOfPages=a;this.maxX=-this.options.numberOfPages*this.pageWidth+this.wrapperWidth},goToPage:function(a){var b;this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className.replace(/(^|\s)swipeview-active(\s|$)/,"");for(b=0;b<3;b++){className=this.masterPages[b].className;/(^|\s)swipeview-loading(\s|$)/.test(className)||(this.masterPages[b].className=!className?"swipeview-loading":className+" swipeview-loading")}a=a<0?0:a>this.options.numberOfPages-1?this.options.numberOfPages-1:a;this.page=a;this.pageIndex=a;this.slider.style.webkitTransitionDuration="0";this.__pos(-a*this.pageWidth);this.currentMasterPage=this.page+1-Math.floor((this.page+1)/3)*3;this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className+" swipeview-active";if(this.currentMasterPage==0){this.masterPages[2].style.left=this.page*100-100+"%";this.masterPages[0].style.left=this.page*100+"%";this.masterPages[1].style.left=this.page*100+100+"%";this.masterPages[2].dataset.upcomingPageIndex=this.page===0?this.options.numberOfPages-1:this.page-1;this.masterPages[0].dataset.upcomingPageIndex=this.page;this.masterPages[1].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1}else if(this.currentMasterPage==1){this.masterPages[0].style.left=this.page*100-100+"%";this.masterPages[1].style.left=this.page*100+"%";this.masterPages[2].style.left=this.page*100+100+"%";this.masterPages[0].dataset.upcomingPageIndex=this.page===0?this.options.numberOfPages-1:this.page-1;this.masterPages[1].dataset.upcomingPageIndex=this.page;this.masterPages[2].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1}else{this.masterPages[1].style.left=this.page*100-100+"%";this.masterPages[2].style.left=this.page*100+"%";this.masterPages[0].style.left=this.page*100+100+"%";this.masterPages[1].dataset.upcomingPageIndex=this.page===0?this.options.numberOfPages-1:this.page-1;this.masterPages[2].dataset.upcomingPageIndex=this.page;this.masterPages[0].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1}this.__flip()},next:function(){if(!this.options.loop&&this.x==this.maxX)return;this.directionX=-1;this.x-=1;this.__checkPosition()},prev:function(){if(!this.options.loop&&this.x===0)return;this.directionX=1;this.x+=1;this.__checkPosition()},handleEvent:function(a){switch(a.type){case c:this.__start(a);break;case d:this.__move(a);break;case f:case e:this.__end(a);break;case b:this.__resize();break;case"webkitTransitionEnd":if(a.target==this.slider&&!this.options.hastyPageFlip)this.__flip();break}},__pos:function(a){this.x=a;this.slider.style.webkitTransform="translate3d("+a+"px,0,0)"},__resize:function(){this.refreshSize();this.slider.style.webkitTransitionDuration="0";this.__pos(-this.page*this.pageWidth)},__start:function(b){if(this.initiated)return;var c=a?b.touches[0]:b;this.initiated=true;this.moved=false;this.thresholdExceeded=false;this.startX=c.pageX;this.startY=c.pageY;this.pointX=c.pageX;this.pointY=c.pageY;this.stepsX=0;this.stepsY=0;this.directionX=0;this.directionLocked=false;this.slider.style.webkitTransitionDuration="0";this.__event("touchstart")},__move:function(b){if(!this.initiated)return;var c=a?b.touches[0]:b,d=c.pageX-this.pointX,e=c.pageY-this.pointY,f=this.x+d,g=Math.abs(c.pageX-this.startX);this.moved=true;this.pointX=c.pageX;this.pointY=c.pageY;this.directionX=d>0?1:d<0?-1:0;this.stepsX+=Math.abs(d);this.stepsY+=Math.abs(e);if(this.stepsX<10&&this.stepsY<10){return}if(!this.directionLocked&&this.stepsY>this.stepsX){this.initiated=false;return}b.preventDefault();this.directionLocked=true;if(!this.options.loop&&(f>0||f<this.maxX)){f=this.x+d/2}if(!this.thresholdExceeded&&g>=this.snapThreshold){this.thresholdExceeded=true;this.__event("moveout")}else if(this.thresholdExceeded&&g<this.snapThreshold){this.thresholdExceeded=false;this.__event("movein")}this.__pos(f)},__end:function(b){if(!this.initiated)return;var c=a?b.changedTouches[0]:b,d=Math.abs(c.pageX-this.startX);this.initiated=false;if(!this.moved)return;if(!this.options.loop&&(this.x>0||this.x<this.maxX)){d=0;this.__event("movein")}if(d<this.snapThreshold){this.slider.style.webkitTransitionDuration=Math.floor(300*d/this.snapThreshold)+"ms";this.__pos(-this.page*this.pageWidth);return}this.__checkPosition()},__checkPosition:function(){var a,b,c;this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className.replace(/(^|\s)swipeview-active(\s|$)/,"");if(this.directionX>0){this.page=-Math.ceil(this.x/this.pageWidth);this.currentMasterPage=this.page+1-Math.floor((this.page+1)/3)*3;this.pageIndex=this.pageIndex===0?this.options.numberOfPages-1:this.pageIndex-1;a=this.currentMasterPage-1;a=a<0?2:a;this.masterPages[a].style.left=this.page*100-100+"%";b=this.page-1}else{this.page=-Math.floor(this.x/this.pageWidth);this.currentMasterPage=this.page+1-Math.floor((this.page+1)/3)*3;this.pageIndex=this.pageIndex==this.options.numberOfPages-1?0:this.pageIndex+1;a=this.currentMasterPage+1;a=a>2?0:a;this.masterPages[a].style.left=this.page*100+100+"%";b=this.page+1}c=this.masterPages[this.currentMasterPage].className;/(^|\s)swipeview-active(\s|$)/.test(c)||(this.masterPages[this.currentMasterPage].className=!c?"swipeview-active":c+" swipeview-active");c=this.masterPages[a].className;/(^|\s)swipeview-loading(\s|$)/.test(c)||(this.masterPages[a].className=!c?"swipeview-loading":c+" swipeview-loading");b=b-Math.floor(b/this.options.numberOfPages)*this.options.numberOfPages;this.masterPages[a].dataset.upcomingPageIndex=b;newX=-this.page*this.pageWidth;this.slider.style.webkitTransitionDuration=Math.floor(500*Math.abs(this.x-newX)/this.pageWidth)+"ms";if(!this.options.loop){this.masterPages[a].style.visibility=newX===0||newX==this.maxX?"hidden":""}if(this.x==newX){this.__flip()}else{this.__pos(newX);if(this.options.hastyPageFlip)this.__flip()}},__flip:function(){this.__event("flip");for(var a=0;a<3;a++){this.masterPages[a].className=this.masterPages[a].className.replace(/(^|\s)swipeview-loading(\s|$)/,"");this.masterPages[a].dataset.pageIndex=this.masterPages[a].dataset.upcomingPageIndex}},__event:function(a){var b=document.createEvent("Event");b.initEvent("swipeview-"+a,true,true);this.wrapper.dispatchEvent(b)}};return g}()